<!DOCTYPE html><html><head><title>VinylDNS: Setup AWS SQS</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="VinylDNS" /><meta name="description" content="DNS Automation and Governance" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="VinylDNS: Setup AWS SQS" /><meta name="title" property="og:title" content="VinylDNS: Setup AWS SQS" /><meta name="og:site_name" content="VinylDNS" /><meta name="og:url" content="https://vinyldns.io" /><meta name="og:type" content="website" /><meta name="og:description" content="DNS Automation and Governance" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="VinylDNS: Setup AWS SQS" /><meta name="twitter:image" content="/img/poster.png" /><meta name="twitter:description" content="DNS Automation and Governance" /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@vinyldns_oss" /><meta name="twitter:creator" content="@vinyldns_oss" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/hybrid.css" /><link rel="stylesheet" href="/css/light-style.css" /><link rel="stylesheet" href="/css/custom.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"></div><span>VinylDNS</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav">        <div class="sidebar-nav-item  "><a href="/operator/index.html" title="Operator Guide" class="">Operator Guide</a></div> <div class="sidebar-nav-item  open"><a href="/operator/pre.html" title="Pre-requisites" class="drop-nested">Pre-requisites</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/operator/setup-mysql.html" title="Setup MySQL" class="">Setup MySQL</a> <a href="/operator/setup-sqs.html" title="Setup AWS SQS" class="active">Setup AWS SQS</a> <a href="/operator/setup-ldap.html" title="Setup LDAP" class="">Setup LDAP</a></div></div> <div class="sidebar-nav-item  "><a href="/operator/setup-api.html" title="Setup API Server" class="drop-nested">Setup API Server</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/operator/config-api.html" title="API Configuration Guide" class="">API Configuration Guide</a></div></div> <div class="sidebar-nav-item  "><a href="/operator/setup-portal.html" title="Setup the Portal Server" class="drop-nested">Setup the Portal Server</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/operator/config-portal.html" title="Portal Configuration Guide" class="">Portal Configuration Guide</a></div></div>      </div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/vinyldns/vinyldns" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/vinyldns/vinyldns" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="vinyldns" data-github-repo="vinyldns"><div class="content-wrapper"><section><h1 id="setup-aws-sqs">Setup AWS SQS</h1>
<p>SQS is used to provide high-availability and failover in the event that a node crashes mid-stream while processing a message.
The backend processing for VinylDNS is built to be idempotent so changes can be fully re-applied.  The SQS queue
also provides a mechanism to <em>throttle</em> updates, in the event that an out-of-control client submits thousands or
millions of concurrent requests, they will all be throttled through SQS.</p>

<p>You must setup an SQS queue before you can start working with VinylDNS.  An <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-getting-started.html">AWS SQS Getting Started Guide</a>
provides the information you need to setup your queue.</p>

<h2 id="setting-up-aws-sqs">Setting up AWS SQS</h2>
<p>As opposed to MySQL where everything is created when the application starts up, the SQS queue needs to be setup by hand.
This section goes through those settings that are required.</p>

<p>The traffic with AWS SQS is rather low.  Presently, Comcast operates multiple SQS queues across multiple environments (dev, staging, prod),
and incur a cost of less than $10 USD per month.  SQS allows up to 1MM requests per month in the <em>free</em> tier.  It is possible
to operate VinylDNS entirely in the “free” tier.  You can “tune down” your usage by increasing your polling interval.</p>

<p>The following SQS Queue Attributes are recommended (these are in AWS when you create an SQS Queue):</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Queue Type</code> - Standard</li>
  <li><code class="language-plaintext highlighter-rouge">Delivery Delay</code> - 0 seconds</li>
  <li><code class="language-plaintext highlighter-rouge">Default Visibility Timeout</code> - 1 minute (how long it takes a record change to complete, usually a second)</li>
  <li><code class="language-plaintext highlighter-rouge">Message Retention Period</code> - 4 days</li>
  <li><code class="language-plaintext highlighter-rouge">Maximum Message Size</code> - 256KB</li>
  <li><code class="language-plaintext highlighter-rouge">Receive Message Wait Time</code> - 0 seconds</li>
  <li><code class="language-plaintext highlighter-rouge">Maximum Receives</code> - 100 (how many times a message will be retried before failing.  Note: if any messages retry more than 100 times, there is likely a problem requiring immediate attention)</li>
  <li><code class="language-plaintext highlighter-rouge">Dead Letter Queue</code> - use a dead letter queue for all queues</li>
</ul>

<h2 id="configuring-sqs">Configuring SQS</h2>
<p>Before you can configure SQS, make note of the AWS account (access key and secret access key) as well as the
SQS Queue Url that you will be using.  Follow the <a href="config-api.html#queue-configuration">SQS Configuration</a> to complete the setup.</p>
</section><div class="edit-button"><a href="https://github.com/vinyldns/vinyldns/edit/master/modules/docs/src/main/mdoc/operator/setup-sqs.md" target="_blank" rel="noopener noreferrer" class="btn-sm btn-info">Improve this page</a></div></div></div></div></div><script src="/highlight/highlight.pack.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/json.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/yaml.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bnf.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/plaintext.min.js"></script><script src="/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash','json','yaml','bnf','plaintext']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/js/search.js"></script><script src="/js/docs.js"></script></body></html>