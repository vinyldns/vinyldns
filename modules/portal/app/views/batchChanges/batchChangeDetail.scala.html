@(rootAccountName: String)(implicit request: play.api.mvc.Request[Any], customLinks: models.CustomLinks, meta: models.Meta)

@content = {
<!-- PAGE CONTENT -->
<div class="right_col" role="main">

    <!-- BREADCRUMB -->
    <ul class="breadcrumb">
        <li><a href="/">Home</a></li>
        <li><a href="/batchchanges">Batch Changes</a></li>
        <li class="active">{{batch.id}}</li>
    </ul>
    <!-- END BREADCRUMB -->

    <!-- PAGE TITLE -->
    <div class="page-title">
        <h3>
            <span class="fa fa-list-ol"></span> Batch Change
            <span ng-if="batch.status == 'Complete'" class="label label-success">{{batch.status}}</span>
            <span ng-if="batch.status == 'Pending' && batch.approvalStatus !='PendingApproval'" class="label label-info">{{batch.status}}</span>
            <span ng-if="batch.status == 'PartialFailure'" class="label label-warning">Partial Failure</span>
            <span ng-if="batch.status == 'Failed' && batch.approvalStatus != 'ManuallyRejected'" class="label label-danger">{{batch.status}}</span>
            <span ng-if="batch.approvalStatus == 'PendingApproval'" class="label label-warning">Pending Review</span>
            <span ng-if="batch.approvalStatus == 'ManuallyRejected'" class="label label-danger">Rejected</span>
        </h3>
    </div>
    <!-- END PAGE TITLE -->


    <!-- PAGE CONTENT WRAPPER -->
    <div class="page-content-wrap">
        <div class="alert-wrapper">
            <div ng-repeat="alert in alerts">
                <notification ng-model="alert"></notification>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <p><strong>Created:</strong> {{batch.createdTimestamp}}</p>
                <p ng-if="batch.comments"><strong>Description:</strong> {{batch.comments}}</p>
                @if(meta.sharedDisplayEnabled) {
                    <p ng-if="batch.ownerGroupName"><strong>Record Owner Group:</strong> {{batch.ownerGroupName}}</p>
                    <p ng-if="batch.ownerGroupId && !batch.ownerGroupName">
                        <strong>Record Owner Group:</strong>
                        <span class="text-danger" data-toggle="tooltip" data-placement="top"
                              title="Group with ID {{batch.ownerGroupId}} no longer exists.">
                            <span class="fa fa-warning"></span> Group deleted
                        </span>
                    </p>
                    <p ng-if="batch.approvalStatus == 'ManuallyApproved'"><strong>Review Status:</strong> Approved</p>
                    <p ng-if="batch.reviewerUserName"><strong>Reviewer:</strong> {{batch.reviewerUserName}}</p>
                    <p ng-if="batch.reviewerId && !batch.reviewerUserName">
                        <strong>Reviewer:</strong>
                        <span class="text-danger" data-toggle="tooltip" data-placement="top"
                              title="Reviewer with ID {{batch.reviewerId}} no longer exists.">
                                    <span class="fa fa-warning"></span> Reviewer deleted
                                </span>
                    </p>
                    <p ng-if="batch.reviewComment"><strong>Review Comment:</strong> {{batch.reviewComment}}</p>
                    <p ng-if="batch.reviewTimestamp"><strong>Review Time:</strong> {{batch.reviewTimestamp}}</p>
                }
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-12">
                <!-- SIMPLE DATABLE -->
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Changes</h3>
                    </div>
                    <div class="panel-body">
                        <!-- SEARCH BOX -->
                        <div class="clearfix">
                            <button class="btn btn-default" ng-click="refresh()"><span class="fa fa-refresh"></span> Refresh</button>
                            <form class="input-group pull-right col-md-3">
                                <div class="input-group">
                                    <span class="input-group-btn">
                                        <button id="batch-change-search-button" type="submit" class="btn btn-primary btn-left-round">
                                            <span class="fa fa-search"></span>
                                        </button>
                                    </span>
                                    <input ng-model="query" type="text" class="form-control"/>
                                </div>
                            </form>
                        </div>
                        <!-- END SEARCH BOX -->
                        <table class="table">
                            <thead>
                            <tr>
                                <th>Change Type</th>
                                <th>Input Name</th>
                                <th>Recordset Name</th>
                                <th>Zone Name</th>
                                <th>Record Type</th>
                                <th class="col-md-2">Record Data</th>
                                <th>TTL</th>
                                <th>Status</th>
                                <th class="col-md-2">Additional Info</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="change in batch.changes|filter:query">
                                <td ng-bind="change.changeType"></td>
                                <td class="wrap-long-text">{{change.inputName}}</td>
                                <td class="wrap-long-text">{{change.recordName}}</td>
                                <td class="wrap-long-text">{{change.zoneName}}</td>
                                <td>{{change.type}}</td>
                                <!--record data name based on record type-->
                                    <td ng-if="change.type=='A'||change.type=='AAAA'" class="wrap-long-text">
                                        {{change.record.address}}
                                    </td>
                                    <td ng-if="change.type=='CNAME'">
                                        {{change.record.cname}}
                                    </td>
                                    <td ng-if="change.type=='PTR'">
                                        {{change.record.ptrdname}}
                                    </td>
                                    <td ng-if="change.type=='TXT'" class="wrap-long-text">
                                        {{change.record.text}}
                                    </td>
                                    <td ng-if="change.type=='MX'">
                                        <ul>
                                            <li class="wrap-long-text">Preference: {{change.record.preference}}</li>
                                            <li class="wrap-long-text">Exchange: {{change.record.exchange}}</li>
                                        </ul>
                                    </td>
                                <!--end record data name based on record type-->
                                <td>{{change.ttl}}</td>
                                <td>
                                    <span ng-if="change.status =='Complete'" class="label label-success">{{change.status}}</span>
                                    <span ng-if="change.status =='Pending'" class="label label-info">{{change.status}}</span>
                                    <span ng-if="change.status =='NeedsReview'" class="label label-warning">Needs Review</span>
                                    <span ng-if="change.status =='Failed'" class="label label-danger">{{change.status}}</span>
                                    <span ng-if="change.status =='Rejected'" class="label label-danger">{{change.status}}</span>
                                </td>
                                <td class="wrap-long-text">
                                    <p ng-repeat="error in change.validationErrors">
                                        {{error.message}}
                                    </p>
                                    {{change.systemMessage}}
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
}

@plugins = {}

@main(rootAccountName)("BatchChangeDetailController")("Batch Change")(content)(plugins)
